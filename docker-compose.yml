version: '3'
services:     
  db:
    build:
      context: .
      dockerfile: ./Dockerfile.db
    restart: always
    environment:
      - ACCEPT_EULA=y
      - SA_PASSWORD=Supersecur3!
    volumes:
      - sql_data:/var/opt/mssql

  api:
    build:
      context: .
      dockerfile: ./Dockerfile.api
    command: Server=db;Database=BOUNTY;Trusted_Connection=True;MultipleActiveResultSets=True
    ports:
      - '80:80'
    depends_on:
      - db

  adminer:
    restart: always
    image: adminer
    ports:
      - 8080:8080
    environment:
      - ADMINER_DEFAULT_SERVER=db
      - ADMINER_DEFAULT_PORT=1433
      - ADMINER_DEFAULT_DB_DRIVER=mssql
      - ADMINER_DEFAULT_USERNAME=SA
      - ADMINER_DEFAULT_PASSWORD=Supersecur3!

volumes:
  sql_data:
